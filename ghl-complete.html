<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Party On Delivery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .category-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .cart-item {
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body>
    <div id="app" class="min-h-screen">
        <!-- Loading Screen -->
        <div id="loading-screen" class="fixed inset-0 bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center z-50">
            <div class="text-center text-white">
                <div class="loading-spinner mb-4"></div>
                <h2 class="text-2xl font-bold mb-2">Party On Delivery</h2>
                <p>Loading your premium delivery experience...</p>
            </div>
        </div>

        <!-- Age Verification Modal -->
        <div id="age-verification" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40" style="display: none;">
            <div class="bg-white rounded-lg p-8 max-w-md mx-4 text-center">
                <h2 class="text-2xl font-bold mb-4">Age Verification Required</h2>
                <p class="mb-6 text-gray-600">You must be 21 or older to access this service.</p>
                <div class="space-y-3">
                    <button onclick="verifyAge(true)" class="btn-primary w-full">I am 21 or older</button>
                    <button onclick="verifyAge(false)" class="w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">I am under 21</button>
                </div>
            </div>
        </div>

        <!-- Main App -->
        <div id="main-app" style="display: none;">
            <!-- Header -->
            <header class="glass-effect text-white p-4">
                <div class="max-w-6xl mx-auto flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center">
                            <span class="text-purple-600 font-bold text-lg">P</span>
                        </div>
                        <h1 class="text-xl font-bold">Party On Delivery</h1>
                    </div>
                    <button onclick="toggleCart()" class="relative btn-primary">
                        üõí Cart (<span id="cart-count">0</span>)
                    </button>
                </div>
            </header>

            <!-- Address Input -->
            <div id="address-section" class="max-w-2xl mx-auto p-6">
                <div class="glass-effect rounded-lg p-6 text-white text-center">
                    <h2 class="text-2xl font-bold mb-4">Enter Your Delivery Address</h2>
                    <div class="space-y-4">
                        <input 
                            id="address-input" 
                            type="text" 
                            placeholder="Enter your address..." 
                            class="w-full px-4 py-3 rounded-lg border text-gray-900"
                        >
                        <button onclick="validateAddress()" class="btn-primary w-full">
                            Continue to Products
                        </button>
                    </div>
                </div>
            </div>

            <!-- Product Categories -->
            <div id="categories-section" class="max-w-6xl mx-auto p-6" style="display: none;">
                <h2 class="text-2xl font-bold text-white text-center mb-8">Choose Your Category</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="category-card glass-effect rounded-lg overflow-hidden" onclick="selectCategory('beer')">
                        <div class="h-40 bg-amber-500"></div>
                        <div class="p-4 text-white text-center">
                            <h3 class="text-lg font-bold">Beer</h3>
                            <p class="text-sm opacity-90">Craft, Import, Domestic</p>
                        </div>
                    </div>
                    <div class="category-card glass-effect rounded-lg overflow-hidden" onclick="selectCategory('cocktails')">
                        <div class="h-40 bg-pink-500"></div>
                        <div class="p-4 text-white text-center">
                            <h3 class="text-lg font-bold">Cocktails</h3>
                            <p class="text-sm opacity-90">Premium Mixers</p>
                        </div>
                    </div>
                    <div class="category-card glass-effect rounded-lg overflow-hidden" onclick="selectCategory('seltzer')">
                        <div class="h-40 bg-blue-500"></div>
                        <div class="p-4 text-white text-center">
                            <h3 class="text-lg font-bold">Seltzer</h3>
                            <p class="text-sm opacity-90">Hard Seltzers & More</p>
                        </div>
                    </div>
                    <div class="category-card glass-effect rounded-lg overflow-hidden" onclick="selectCategory('party-supplies')">
                        <div class="h-40 bg-green-500"></div>
                        <div class="p-4 text-white text-center">
                            <h3 class="text-lg font-bold">Party Supplies</h3>
                            <p class="text-sm opacity-90">Everything You Need</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Grid -->
            <div id="products-section" class="max-w-6xl mx-auto p-6" style="display: none;">
                <div class="flex justify-between items-center mb-6">
                    <button onclick="goBack()" class="text-white hover:underline">‚Üê Back to Categories</button>
                    <h2 id="category-title" class="text-2xl font-bold text-white"></h2>
                    <div></div>
                </div>
                <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Products will be loaded here -->
                </div>
            </div>

            <!-- Shopping Cart -->
            <div id="cart-sidebar" class="fixed right-0 top-0 h-full w-96 bg-white shadow-lg transform translate-x-full transition-transform z-30">
                <div class="p-4 border-b">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-bold">Shopping Cart</h3>
                        <button onclick="toggleCart()" class="text-gray-500">‚úï</button>
                    </div>
                </div>
                <div id="cart-items" class="flex-1 overflow-y-auto p-4">
                    <div id="empty-cart" class="text-center text-gray-500 py-8">
                        Your cart is empty
                    </div>
                </div>
                <div id="cart-footer" class="border-t p-4" style="display: none;">
                    <div class="flex justify-between items-center mb-4">
                        <span class="font-bold">Total: $<span id="cart-total">0.00</span></span>
                    </div>
                    <button onclick="proceedToCheckout()" class="btn-primary w-full">
                        Proceed to Checkout
                    </button>
                </div>
            </div>

            <!-- Checkout Form -->
            <div id="checkout-section" class="max-w-2xl mx-auto p-6" style="display: none;">
                <div class="glass-effect rounded-lg p-6 text-white">
                    <h2 class="text-2xl font-bold mb-6">Checkout</h2>
                    <form id="checkout-form" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Full Name</label>
                            <input type="text" id="customer-name" required class="w-full px-3 py-2 border rounded-lg text-gray-900">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Phone Number</label>
                            <input type="tel" id="customer-phone" required class="w-full px-3 py-2 border rounded-lg text-gray-900">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" id="customer-email" required class="w-full px-3 py-2 border rounded-lg text-gray-900">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Delivery Instructions</label>
                            <textarea id="delivery-instructions" rows="3" class="w-full px-3 py-2 border rounded-lg text-gray-900"></textarea>
                        </div>
                        <button type="submit" class="btn-primary w-full">
                            Place Order - $<span id="final-total">0.00</span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let cart = [];
        let currentCategory = null;
        let customerAddress = '';
        let isAgeVerified = false;

        // Sample products data
        const products = {
            beer: [
                { id: 1, name: 'Craft IPA', price: 12.99, image: '', description: 'Local craft IPA' },
                { id: 2, name: 'Premium Lager', price: 10.99, image: '', description: 'Premium imported lager' },
                { id: 3, name: 'Wheat Beer', price: 11.99, image: '', description: 'Smooth wheat beer' }
            ],
            cocktails: [
                { id: 4, name: 'Margarita Mix', price: 15.99, image: '', description: 'Premium margarita mixer' },
                { id: 5, name: 'Old Fashioned Kit', price: 24.99, image: '', description: 'Complete old fashioned kit' }
            ],
            seltzer: [
                { id: 6, name: 'Hard Seltzer Variety', price: 13.99, image: '', description: '12-pack variety' },
                { id: 7, name: 'Flavored Seltzer', price: 11.99, image: '', description: 'Tropical flavors' }
            ],
            'party-supplies': [
                { id: 8, name: 'Party Pack', price: 29.99, image: '', description: 'Complete party supplies' },
                { id: 9, name: 'Ice & Cups', price: 8.99, image: '', description: 'Ice and disposable cups' }
            ]
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.getElementById('loading-screen').style.display = 'none';
                document.getElementById('age-verification').style.display = 'flex';
            }, 2000);
        });

        // Age verification
        function verifyAge(isOver21) {
            if (isOver21) {
                isAgeVerified = true;
                document.getElementById('age-verification').style.display = 'none';
                document.getElementById('main-app').style.display = 'block';
            } else {
                alert('You must be 21 or older to use this service.');
            }
        }

        // Address validation
        function validateAddress() {
            const address = document.getElementById('address-input').value;
            if (address.trim()) {
                customerAddress = address;
                document.getElementById('address-section').style.display = 'none';
                document.getElementById('categories-section').style.display = 'block';
            } else {
                alert('Please enter a valid address.');
            }
        }

        // Category selection
        function selectCategory(category) {
            currentCategory = category;
            document.getElementById('categories-section').style.display = 'none';
            document.getElementById('products-section').style.display = 'block';
            document.getElementById('category-title').textContent = category.charAt(0).toUpperCase() + category.slice(1);
            loadProducts(category);
        }

        // Load products
        function loadProducts(category) {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = '';
            
            products[category].forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'glass-effect rounded-lg overflow-hidden';
                productCard.innerHTML = `
                    <div class="h-48 bg-gray-300"></div>
                    <div class="p-4 text-white">
                        <h3 class="font-bold mb-2">${product.name}</h3>
                        <p class="text-sm opacity-90 mb-3">${product.description}</p>
                        <div class="flex justify-between items-center">
                            <span class="text-lg font-bold">$${product.price}</span>
                            <button onclick="addToCart(${product.id})" class="btn-primary">Add to Cart</button>
                        </div>
                    </div>
                `;
                grid.appendChild(productCard);
            });
        }

        // Cart functions
        function addToCart(productId) {
            const product = Object.values(products).flat().find(p => p.id === productId);
            if (product) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                updateCartDisplay();
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
        }

        function updateCartDisplay() {
            const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartTotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            document.getElementById('cart-count').textContent = cartCount;
            document.getElementById('cart-total').textContent = cartTotal.toFixed(2);
            document.getElementById('final-total').textContent = cartTotal.toFixed(2);

            const cartItems = document.getElementById('cart-items');
            if (cart.length === 0) {
                cartItems.innerHTML = '<div id="empty-cart" class="text-center text-gray-500 py-8">Your cart is empty</div>';
                document.getElementById('cart-footer').style.display = 'none';
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="cart-item border-b pb-3 mb-3">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-medium">${item.name}</h4>
                                <p class="text-sm text-gray-600">$${item.price} x ${item.quantity}</p>
                            </div>
                            <button onclick="removeFromCart(${item.id})" class="text-red-500">Remove</button>
                        </div>
                    </div>
                `).join('');
                document.getElementById('cart-footer').style.display = 'block';
            }
        }

        function toggleCart() {
            const cart = document.getElementById('cart-sidebar');
            const isOpen = cart.style.transform === 'translateX(0px)';
            cart.style.transform = isOpen ? 'translateX(100%)' : 'translateX(0px)';
        }

        function proceedToCheckout() {
            toggleCart();
            document.getElementById('products-section').style.display = 'none';
            document.getElementById('categories-section').style.display = 'none';
            document.getElementById('checkout-section').style.display = 'block';
        }

        function goBack() {
            document.getElementById('products-section').style.display = 'none';
            document.getElementById('categories-section').style.display = 'block';
        }

        // Checkout form submission
        document.getElementById('checkout-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const customerName = document.getElementById('customer-name').value;
            const customerPhone = document.getElementById('customer-phone').value;
            const customerEmail = document.getElementById('customer-email').value;
            
            if (customerName && customerPhone && customerEmail) {
                alert('Order placed successfully! You will receive a confirmation email shortly.');
                // Reset app
                cart = [];
                updateCartDisplay();
                document.getElementById('checkout-section').style.display = 'none';
                document.getElementById('address-section').style.display = 'block';
                document.getElementById('checkout-form').reset();
            }
        });
    </script>
</body>
</html>